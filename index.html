<!DOCTYPE html>
<html lang="en">
<!--
Title: ArcGIS Portal Thumbnail Generator
Purpose: To allow people to generate a thumbnail for use in ArcGIS Portal. By selecting a few options and uploading
            the thumbnail they want to use, this page generates the thumbnail for them.
Authors:    Rick Smith - Conrad Blucher Institute for Surveying and Science - Richard.Smith@tamucc.edu
            Rodrigo Davila Castillo - Conrad Blucher Institute for Surveying and Science - rodrigo.davilacastillo@tamucc.edu
Date: March 24, 2025
How to maintain: Two selects should be updated with new application types and source icons. When updating icons,
                    place them in the logos directory and set the value of the option to the logo file name.
                 Image tag with id 'thumb' sets default thumbnail background. Is hidden from visibility. Change
                    path to default logo if desired.
Required javascript libraries:
    *PortalThumbnailGenerator.js - Custom library, handles thumbnail generation
    *PortalAuthentication.js - Custom library, handles ArcGIS Portal authentication and ArcGIS item queries
    *Bootstrap 5
    *jQuery
-->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>CBI Portal Thumbnail Generator</title>
	<link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png">
	<link rel="manifest" href="favicons/site.webmanifest">
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">
    <link href="css/PortalThumbnailGenerator.css" rel="stylesheet" type="text/css"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
</head>
<body>
    <div class="container">
        <div class="row py-4">
            <div class="p-5 text-center bg-primary text-white rounded-3">
                <h1>CBI Portal Thumbnail Generator</h1>
                <p>Never use a default thumbnail again!</p>
            </div>
        </div>
        <div class="row">
            <div class="alert alert-primary" role="alert">
                <div class="alert-header d-flex fs-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi mt-1 bi-info-circle-fill" viewBox="0 0 16 16"><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/>
                    </svg>
                    <div class="alert-header-text">
                        <h2 class="ms-2 alert-heading">Instructions</h2>
                    </div>
                </div>
                <div>   
                    <ol>
                        <li>Select the portal item type.</li>
                        <li>Check box if external source.</li>
                        <li>Select the source logo.</li>
                        <li>Choose screenshot to insert <i>or if the screenshot is in your clipboard,
                                click CTRL-V to paste directly onto this page.</i></li>
                        <li>Download the thumbnail to your computer.</li>
                    </ol>
    
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xl-5 col-lg-4 order-2 order-lg-1">
                <div class="alert alert-light form-text" role="alert" id="userInfo">
                    <div class="d-flex align-items-center signedOutElements">
                        <!-- Message displayed when signed in, sign-in button -->
                        <div class="me-auto" id="userSignedOutMessage">
                            You are not signed into CBI Maps.
                        </div>
                        <div>
                            <button type="button" class="btn btn-primary btn-sm text-nowrap ms-3" id="arcgisPortalSignIn">Sign in</button>
                        </div>
                    </div>
                    <div class="d-flex align-items-center d-none signedInElements">
                        <!-- Message displayed when signed in, sign-in button -->
                        <div class="me-auto" id="userSignedInMessage"></div>
                        <div>
                            <button type="button" class="btn btn-primary btn-sm text-nowrap ms-3" id="arcgisPortalSignOut">Sign out</button>
                        </div>
                    </div>   
                </div>

                <div class="card thumbnailGenCard">
                    <!-- Tabs -->
                    <div class="card-header">
                        <ul class="nav nav-pills nav-justified card-header-pills" id="thumbnailGenTabs" role="tablist">
                        <!-- <ul class="nav nav-tabs nav-fill card-header-tabs"  id="thumbnail-gen-tabs" role="tablist"> -->
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="thumbnailGenSelectItemTab" data-bs-toggle="pill" data-bs-target="#thumbnailGenSelectItem" type="button" role="tab" aria-controls="thumbnailGenSelectItem" aria-selected="true">
                                    1. Select item
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link disabled" id="thumbnailGenItemDataTab" data-bs-toggle="pill" data-bs-target="#thumbnailGenItemData" type="button" role="tab" aria-controls="thumbnailGenItemData" aria-selected="true" aria-disabled="true">
                                    2. Enter item data
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link disabled" id="thumbnailGenMakeThumbnailTab" data-bs-toggle="pill" data-bs-target="#thumbnailGenMakeThumbnail" type="button" role="tab" aria-controls="thumbnailGenMakeThumbnail" aria-selected="true" aria-disabled="true">
                                    3. Make thumbnail
                                </button>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Tab content -->
                    <div class="tab-content">
                        <!-- 1. Select item -->
                        <div class="card-body tab-pane fade show active" role="tabpanel" id="thumbnailGenSelectItem" aria-labelledby="pills-home-tab" tabindex="0">
                            <div class="card-title fs-5">Select your item</div>
                            <p class="card-text">Choose your item from the CBI Maps portal, or skip this step and enter the item's data manually.</p>
                            <div class="card-title fs-6">CBI Maps item search / item ID</div>
                            <div class="input-group signedOutElements">
                                <input type="text" class="form-control" placeholder="Sign in to search for items" aria-label="Item ID" id="thumbnailGenItemSearchInputSignedOut" aria-describedby="thumbnailGenItemSearchButtonSignedOut" disabled>
                                <button class="btn btn-outline-secondary" type="button" id="thumbnailGenItemSearchButtonSignedOut" disabled>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="signedInElements d-none">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Search or enter item ID..." aria-label="Item ID" id="thumbnailGenItemSearchInput">
                                    <button class="btn btn-outline-secondary" type="button" id="thumbnailGenItemSearchButton">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div id="thumbnailGenItemSearchResults">
                                    <ul class="list-group">
                                        <!-- TODO: make an array of these for each list item. And make clicks go to the next step. -->
                                        <a href="#" class="list-group-item list-group-item-action">
                                            <div class="fs-5">Feature item title</div>
                                            <div class="fs-6">Feature item type</div>
                                        </a>
                                    </ul>
                                </div>
                            </div>
                            <div class="text-center my-3 fst-italic">or</div>
                            <button type="button" class="btn btn-light w-100" id="thumbnailGenSkipItemSelection">
                                Skip
                            </button>
                        </div>

                        <!-- 2. Enter item data -->
                        <div class="card-body tab-pane fade" role="tabpanel" id="thumbnailGenItemData" aria-labelledby="pills-home-tab" tabindex="0">
                            <div class="card-title fs-5">Enter item data</div>
                            <p class="card-text">Enter the item's data. If you selected an item from the portal, some of this information was autofilled for you.</p>
                            <!-- Item type selection -->
                            <div class="form-group mb-2">
                                <!-- Application type select. Add new entries for new types of applications.
                                    I think this is a complete list of items possible
                                    https://pro.arcgis.com/en/pro-app/latest/help/projects/supported-data-types-and-items.htm
                                    but don't want to add them all to junk up the list.-->
                                <label for="applicationType" class="form-label fw-bold">Item Type</label>
                                <select class="form-select" id="applicationType">
                                    <option value='other'>Other (Enter Type)</option>
                                    <option>CSV</option>
                                    <option>Dashboard</option>
                                    <option>Document</option>
                                    <option>Feature Layer</option>
                                    <option>File</option>
                                    <option>Gallery</option>
                                    <option>Imagery Layer</option>
                                    <option>Locator</option>
                                    <option selected="selected">Map Image Layer</option>
                                    <option>Mobile Map Package</option>
                                    <option>Scene Layer</option>
                                    <option>Service Definition</option>
                                    <option>Tile Layer</option>
                                    <option>Vector Tile Layer</option>
                                    <option>Web Tool</option>
                                    <option>Web App</option>
                                    <option>Web Map</option>
                                    <option>Web Scene</option>
                                    <option>WFS Layer</option>
                                    <option>WMS Layer</option>
                                </select>
                                <span id="customApplicationType" style="display:none">
                                    <label for="customapplicationtype">Other Item Type</label>
                                    <input class='form-control' type="text" id="customapplicationtype" name="customapplicationtype" />
                                </span>
                            </div>
                            <!-- External source selection -->
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="external">
                                <label class="form-check-label" for="external">
                                    External Source (References service on an external server)
                                </label>
                            </div>
                            <!-- Source logo selection -->
                            <div class="form-group mb-2">
                                <label for="sourceIcon" class="form-label fw-bold">Source Logo</label>
                                <!-- Each option should have a value. Each value should be the file name
                                    in the logos directory (no spaces in file name please)-->
                                <select class="form-select" id="sourceIcon">
                                    <option value="Other.png">Other (Upload Logo)</option>
                                    <option value="None.png">None</option>
                                    <option value="ai2es-logo.png">AI2ES</option>
                                    <option value="cats-logo.png">CATS</option>
                                    <option value="CBI.png" selected="selected">CBI</option>
                                    <option value="cdl-logo.png">CDL Lab</option>
                                    <option value="goal-logo.png">GOAL Lab</option>
                                    <option value="mantis-logo.jpg">MANTIS Lab</option>
                                    <option value="TNRIS.png">TNRIS</option>
                                    <option value="tsrc-logo.png">TSRC</option>
                                </select>
                            </div>
                            <!-- Custom source icon file upload [hidden by default] -->
                            <div class="form-group mb-2">
                                <div id="customLogoBlock" style="display:none">
                                    <label class="form-label" for="customlogo">Other Source Icon</label>
                                    <input class='form-control' type="file" id="customlogo" name="customlogo" />
                                </div>
                                <output id="logoDetails" class="d-none"><img src = "logos/Other.png" id="customlogofile" style="display:none" /></output>
                            </div>
                            <!-- Next step -->
                            <button type="button" class="btn btn-primary w-100 mt-2" id="thumbnailGenItemDataNextStep">
                                Next step
                            </button>
                        </div>

                        <!-- 3. Make thumbnail -->
                        <div class="card-body tab-pane fade" role="tabpanel" id="thumbnailGenMakeThumbnail" aria-labelledby="pills-home-tab" tabindex="0">
                            <div class="card-title fs-5">Make thumbnail</div>
                            <p class="card-text">Customize your thumbnail and push it to your item on the portal, or just download it.</p>
                            <!-- Screenshot file upload -->
                            <div class="form-group mb-2">
                                <!-- Radio button selector for ArcGIS Portal or an uploaded image -->
                                <fieldset id="imageSourceControls">
                                    <label for="file" class="form-label d-block fw-bold">Screenshot source</label>
                                    <div class="d-inline-flex flex-fill w-100">
                                        <div class="form-check flex-fill">
                                            <label class="form-check-label">
                                                <input class="form-check-input" type="radio" name="imageSource" id="imageSourceArcgisThumbnail" value="arcgisPortalThumbnail">
                                                Default item thumbnail
                                            </label>
                                        </div>
                                        <div class="form-check flex-fill">
                                            <label class="form-check-label">
                                                <input class="form-check-input" type="radio" name="imageSource" id="imageSourceFileUpload" value="fileUpload">
                                                Image upload
                                            </label>
                                        </div>
                                    </div>
                                </fieldset>
                                <!-- ArcGIS Portal default thumbnail upload option -->
                                <div class="d-none" id="arcgisPortalDefaultThumbnailSelect">
                                    <!-- Message displayed when signed out -->
                                    <button type="button" class="btn btn-secondary w-100 mt-2 signedOutElements" disabled>
                                        You are not signed in.
                                    </button>
                                    <button type="button" class="btn btn-secondary w-100 mt-2 signedInElements noSelection d-none" disabled>
                                        You have not selected an item.
                                    </button>
                                    <button type="button" class="btn btn-secondary w-100 mt-2 signedInElements requiresSelection d-none">
                                        You are not signed in.
                                    </button>
                                </div>
                                <!-- File upload option -->
                                <div class="d-none" id="userImageOptions">
                                    <input class='form-control' type="file" id="file" name="file" />
                                    <div class="form-text">
                                        For best results, your screenshot should have an aspect ratio 1.5:1.<br />
                                        Example sizes (<em>width</em> x <em>height</em>): 200x133, 450x300, 750x500, 1500x1000.<br />
                                        <a href="https://support.microsoft.com/en-us/help/13776/windows-use-snipping-tool-to-capture-screenshots" 
                                        target="_blank">Windows Snipping Tool</a> or 
                                        <a href="https://getsharex.com/" target="_blank">ShareX</a> are good screenshot utilties.
                                    </div>
                                    <!-- Hidden image to store loaded thumbnail from user. Defaults to default screenshot png in root directory. -->
                                    <output id="fileDetails"><img src = "Screenshot_default.png" id="thumb" style="display:none" /></output>
                                </div>
                            </div>
                            <fieldset id="imagePositionControls">
                                <legend class="form-label fw-bold fs-6">Screenshot position</legend>
                                <div class="d-inline-flex flex-fill w-100">
                                    <div class="form-check flex-fill">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="radio" name="imagePosition" id="imageStretch" value="imageStretch" checked>
                                            Stretch image
                                        </label>
                                    </div>
                                    <div class="form-check flex-fill">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="radio" name="imagePosition" id="imageFill" value="imageFill">
                                            Fill image
                                        </label>
                                    </div>
                                    <div class="form-check flex-fill">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="radio" name="imagePosition" id="imageFit" value="imageCenter">
                                            Center image
                                        </label>
                                    </div>
                                </div>
                            </fieldset>
                            <div class="d-flex flex-fill gap-3">
                                <div class="w-50">
                                    <button type="button" class="btn btn-primary w-100 mt-2" id="downloadThumbnail">
                                        Download thumbnail
                                    </button>
                                </div>
                                <div class="w-50 noSelection">
                                    <button type="button" class="btn btn-secondary w-100 mt-2" id="downloadThumbnail" disabled>
                                        Set thumbnail
                                    </button>
                                    <div class="form-text">
                                        You will need to sign into CBI Maps and select an item from there to use this option.
                                    </div>
                                </div>
                                <div class="w-50 requiresSelection">
                                    <button type="button" class="btn btn-primary w-100 mt-2" id="downloadThumbnail">
                                        Upload thumbnail
                                    </button>
                                    <div class="form-text">
                                        This will set the item's thumbnail on CBI Maps.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TODO: make the card footer display the current active feature -->
                </div>
            </div>
            <div class="col-lg-8 col-xl-7 mx-xl-auto d-flex flex-column align-items-xl-end gap-3 order-1 order-lg-2 mb-3">
                <div class="canvas-height w-100 position-relative bg-secondary-subtle">
                    <canvas id="thumbnail" class="thumbnailCanvas position-absolute top-50 start-50 translate-middle" height="400px" width="600px">
                        <em>If you see this text, your browser does not support the HTML5 canvas tag
                        and this application will not work.</em>
                    </canvas>
                </div>
                <div class="w-100">

                </div>
            </div>
        </div>
        <div class="row">
            <div class="col col-lg-12">
                <hr>
                <p>Developed by Rick Smith - Conrad Blucher Institute for Surveying and Science - Richard.Smith@tamucc.edu</p>
                
            </div>
        </div>
    <!-- End Container -->
    </div>

<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="js/bootstrap.bundle.min.js"></script>
<!-- ArcGIS Calcite elements, core API -->
<!-- Load Calcite -->
<script type="module" src="https://js.arcgis.com/calcite-components/3.0.3/calcite.esm.js"></script>
<!-- Load the ArcGIS Maps SDK for JavaScript core API -->
<link rel="stylesheet" href="https://js.arcgis.com/4.32/esri/themes/dark/main.css"/>
<script src="https://js.arcgis.com/4.32/"></script>
<!-- Custom javascript for the thumbnail generator.-->
<script type="text/javascript" src="js/PortalThumbnailGenerator.js"></script>
<!-- Authentication JS -->
<script type="text/javascript" src="js/PortalAuthentication.js"></script>
</body>
</html>